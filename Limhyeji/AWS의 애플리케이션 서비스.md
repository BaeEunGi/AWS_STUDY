# 1-5 AWS의 애플리케이션 서비스

AWS를 보다 효율적으로 사용해서 시스템을 구축/운용하기 위해 애플리케이션 서비스를 잘 활용해야 한다

**애플리케이션 서비스의 개념**과 **AWS가 제공하는 주요 서비스, 장점** 알아보기!

## AWS의 애플리케이션 서비스 개요

많은 사용자가 사용하는 범용 서비스를 AWS의 대규모 자원을 사용해 개발/운용 -> **적은 비용으로 높은 품질**의 서비스 제공

### 확장된 인프라

- 애플리케이션 서비스는 각각의 사용자/시스템 전용이 아닌 **여러 사용자가 사용할 것**을 전제로 만들어져 있다

- 한명의 사용자가 서버 등의 자원 사용 효율이 좋아 확장할 때의 비용이 적으며 돌발적으로 많은 자원을 사용해도 전체 서비스에 대한 영향이 거의 없다 

- 일시적인 사용을 위해 서버를 늘릴 필요 X

### 구축 또는 운용을 하지 않아도 된다는 것

모든 것을 서비스 제공자가 구축해주며 수 많은 리소스를 일괄적으로 관리해준다 -> 따로 신경쓸 필요X

## SES와 SQS

- **SES** : 메일 전송 서비스
- **SQS** 
  -  큐 서비스
  - 가장 오래된 AWS 서비스
  - 느슨한 결합과 간련된 기능 제공 (다른 클래스를 직접적으로 사용하는 클래스의 의존성을 줄이는 것)

### Amazon Simple Email Service - SES

- 굉장히 **신뢰성**이 높은 **메일 전송 서비스**
  + 서비스 사용자에게 확실하게 메일을 전송
  + 메일 수신자에게 바이어스 또는 스팸 메일이 전달되지 않게 해줌 (짧은 시간 대량 메일을 보내거나 과거 이력 평판이 낮은 곳 메일 차단)

### SES의 제약

SES는 **신뢰성**을 유지하기 위해 사용자에게 몇 가지 제약을 걸고 있음

아래의 조건을 지키지 않으면 SES 사용에 제한이 걸림

- 등록한 메일 주소 또는 도메인만 사용 가능 -> 등록 시 메일 또는 도메인의 정식 소유자임을 증명해야 함
- **Bounce Mail(전달 불가능한 메일)**의 비율을 5%로 유지해야 한다
  + Bounce Mail : 수신인이 명확하지 않은 상태로 메일을 보내거나 수신 거부 등을 걸어 놓은 수신인에게 메일을 보내는 것
- 메일에 대한 **불평(Complain)**을 0.1% 이하로 유지해야 한다
  + 메일에 대한 피드백에 스팸이라고 보고 되는 등의 불평이 많이 들어오는 경우
- 악의 있는 콘텐츠를 보내지 않는다.
  + 바이러스 등을 포함한 메일

### Amazon SImple Queue Service - SQS

**메시지 큐 서비스**로 AWS 서비스 중에서 가장 오래된 서비스

**시스템 연계**에 가장 큰 역할을 담당 -> 확장성과 신뢰성이 뛰어나며 가용성이 높은 시스템 구축 가능

**<이용과정>**

1. 작업 등록자는 메시지를 이용해 큐에 작업을 등록
2. 수신자는 SQS에 지속적으로 폴링(주기적으로 확인)
3. 메시지가 있는경우 처리 -> 처리할 때는 록이 걸리므로 다른 수신자는 해당 메시지 확인 불가
4. 처리가 완료되면 큐에서 메시지 삭제

<img src = "https://user-images.githubusercontent.com/59350891/104128902-7d34ec00-53ad-11eb-8d57-67b6fbc41f97.png" width = 50%>

### SQS의 기능

- 전송한 메시지는 **무조건 도달**한다. 다만 2번 이상 같은 메시지를 수신할 가능성은 있다

  + SQS에 메시지를 저장하면 데이터를 잃을 위험은 없다

  + 메시지의 가용성을 중시한 설계이기 때문

- 메시지 **순서**는 보장하지 않는다 

  + 순서가 필요한 경우에는 메시지에 순서와 관련된 정보 추가하기

### SQS의 동작 상세

병렬 처리를 위해 메시지에 **록**을 거는 기능이 있다

특정 메시지가 수신됨녀 해당 메시지에 록을 걸어 둔다. -> 이 동안에는 메시지를 다른 곳에 보내지 않는다

## SNS와 CloudWatch

**SNS** : AWS의 알림 서비스

**CloudWatch** : AWS의 감시 서비스

### Amazon Simple Notificatin Service - SNS

**푸시 형태의 알림 서비스**

**멀티 프로토콜**이므로 여러 개의 프로토콜에 간단하게 알림을 보낼 수 있다

시스템 이벤트 알림의 핵심을 담당한다

### SNS의 사용

**토픽**이라는 단위로 관리

- 알림 하는 사람(Publisher) : 토픽에 메시지를 전달하기만 하면 해당 토픽을 구독하는 사람들에게 메시지 전달
- 알림 받는 사람(Subscriber) : 사용하는 토픽을 받을 프로토콜(ios, android등)을 등록 -> 구독

### Amazon CloudWatch

**AWS의 각종 자원을 모니터링하는 서비스**

- 정의한 감시 조건이 일치하는 경우 정보를 알림하는 기능
- CloudWatch Logs라고 부르는 인스턴스 로그 저장 기능

### CloudWatch 알림 기능

AWS의 각종 자원에 **감시 조건(매트릭스)**라는 것을 사용

EC2, RDS, ELB 등의 자원 마다 기본적으로 감시할 수 있는 항목이 자동적으로 설정

기본적으로 설정된 이외의 것은 사용자 정의 매트릭스를 사용해 감시

### CloudWatch Logs

- **로그 수집**
  + EC2 인스턴스와 Elastic Beanstalk 등의 로그를 S3에 저장
- **감시**
  + 수집한 로그를 설정한 매트릭스로 감시 -> 조건이 일치하면 알림 발생













